
The following roadmap provides a prioritized list of remediation actions, mapped against the discovered vulnerabilities. Fixes are categorized into **High**, **Medium**, and **Low** priority based on their potential impact and exploitability.

---
## High Priority
These vulnerabilities pose an immediate risk to the confidentiality, integrity, or availability of the application and its data. They should be addressed first.

- **SQL Injection (Product Search)**  
  → Implement parameterized queries (prepared statements).  
  → Perform strict input validation.  

- **Weak Password Storage (MD5)**  
  → Replace MD5 with a modern hashing algorithm (e.g., bcrypt, Argon2).  
  → Introduce salting and stretching.  

- **IDOR (Use other users’ card for payment)**  
  → Enforce authorization checks on every sensitive action.  
  → Validate object references server-side.  

- **XSS in Product Search**  
  → Implement output encoding (e.g., HTML entity encoding).  
  → Use Content Security Policy (CSP) site-wide.  

- **JWT Token Contains Password**  
  → Never embed sensitive data (like hashes) in tokens.  
  → Store only minimal user claims.  

- **RCE Possibility via File Upload**  
  → Validate file type and MIME type server-side.  
  → Store files outside the webroot.  
  → Implement antivirus/malware scanning.  

---
## Medium Priority
Vulnerabilities that could aid an attacker in escalating privileges or conducting indirect attacks. Should be remediated after the high-priority issues are closed.

- **Predictable IDs (Users, Baskets, Cards)**  
  → Use UUIDs or random identifiers instead of incremental IDs.  

- **JWT Still Valid After Logout**  
  → Implement token blacklisting or short-lived tokens with refresh.  

- **Brute Forceable Login**  
  → Introduce rate limiting and account lockouts after repeated failed attempts.  
  → Add CAPTCHA or MFA.  

- **Weak Password Policy**  
  → Require minimum length (12+), complexity, and prevent common passwords.  
  → Encourage MFA for all users.  

- **Loose CORS Policy**  
  → Restrict `Access-Control-Allow-Origin` to trusted domains only.  

- **Limited CSP Coverage**  
  → Extend CSP header to all endpoints, not just `/profile`.  

- **Sensitive Data on FTP**  
  → Remove confidential documents from public-facing directories.  
  → Restrict access or move them to secure storage.  

---
## Low Priority
These findings increase the attack surface or leak minor information. They are less critical but should be addressed as part of long-term security hardening.

- **robots.txt Disclosure**  
  → Avoid listing sensitive directories like `/ftp`.  

- **Open FTP Directory Browsing**  
  → Disable directory listing.  
  → Restrict access to required file types only.  

- **Coupon Predictability (Base64 encoded)**  
  → Use cryptographically secure random generation for coupons.  
  → Validate coupon usage server-side.  

- **Emails Exposed in Comments**  
  → Show usernames or anonymized handles instead of email addresses.  

---
## Strategic Improvements (Long-Term)
Beyond individual fixes, the following strategic actions are recommended:

- **Secure Development Lifecycle (SDL)**  
  Introduce security checks during development (linting, code reviews, dependency checks).  

- **Regular Security Testing**  
  Conduct periodic penetration tests and automated vulnerability scanning.  

- **Centralized Logging & Monitoring**  
  Implement monitoring for suspicious activity and alerting for anomalies.  

- **Security Training**  
  Provide developers with OWASP Top 10 and secure coding practices training.  
